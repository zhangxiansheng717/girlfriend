<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘¸ å¥³ç‹å¤§äººçš„ä¸“å±ç¤¼ç‰©ç›²ç›’</title>
    <style>
        body {
            background-color: #ffe6e6; /* æµªæ¼«ç²‰èƒŒæ™¯ */
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        h1 {
            color: #d63384;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .wheel-container {
            position: relative;
            width: 300px;
            height: 300px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            border-radius: 50%;
            border: 10px solid #fff;
        }

        /* çº¯CSSç”»è½¬ç›˜ï¼Œæ— éœ€å›¾ç‰‡ */
        #wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99); /* æ—‹è½¬åŠ¨ç”»æ›²çº¿ */
            /* æ‰‡å½¢é¢œè‰²åœ¨JSä¸­åŠ¨æ€ç”Ÿæˆï¼Œè¿™é‡Œç•™ç©º */
        }

        /* æŒ‡é’ˆ */
        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #ff4757;
            z-index: 10;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));
        }

        /* ä¸­é—´æŒ‰é’® */
        .center-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #d63384;
            font-size: 18px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            cursor: pointer;
            z-index: 5;
            user-select: none;
        }

        .center-btn:active {
            background: #f0f0f0;
            transform: translate(-50%, -50%) scale(0.95);
        }

        .result-modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .modal-content {
            background: #fff;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            width: 80%;
            max-width: 300px;
            animation: popIn 0.3s ease;
        }

        .modal-title { font-size: 20px; font-weight: bold; margin-bottom: 10px; }
        .modal-text { font-size: 16px; color: #333; margin-bottom: 20px; line-height: 1.5; }
        .modal-score { color: #ff4757; font-weight: bold; font-size: 18px; }
        .close-btn {
            background: #d63384; color: #fff; border: none;
            padding: 10px 20px; border-radius: 20px; cursor: pointer; font-size: 16px;
        }

        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body>

    <h1>âœ¨ è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„æŒ‰é’® âœ¨</h1>
    
    <div class="wheel-container">
        <div class="pointer"></div>
        <div id="wheel"></div>
        <div class="center-btn" onclick="startSpin()">æŠ½ å¥–</div>
    </div>

    <!-- å¼¹çª— -->
    <div class="result-modal" id="modal">
        <div class="modal-content">
            <div class="modal-title">ğŸ‰ ç»“æœå‡ºç‚‰ ğŸ‰</div>
            <div class="modal-text" id="resultText"></div>
            <div class="modal-score" id="resultScore"></div>
            <br>
            <p style="font-size:12px; color:#888;">*è¯·æˆªå›¾å‘ç»™ä½ çš„ç”·æœ‹å‹å…‘æ¢å“¦</p>
            <button class="close-btn" onclick="closeModal()">å¼€å¿ƒæ”¶ä¸‹</button>
        </div>
    </div>

    <script>
        // ================= é…ç½®åŒº =================
        // ä½ åœ¨è¿™é‡Œä¿®æ”¹å¥–å“ã€æ¦‚ç‡ï¼ˆweightï¼‰å’Œç§¯åˆ†
        // ç°åœ¨çš„è®¾ç½®ï¼šè¶Šè´µçš„ weight è¶Šå°ï¼Œè¶Šéš¾æŠ½ä¸­
        const prizes = [
            { name: "Lv5: 400-500å…ƒå¤§ç¤¼", color: "#ffadad", weight: 5, score: 10 },
            { name: "Lv4: 300-400å…ƒæƒŠå–œ", color: "#ffd6a5", weight: 15, score: 30 },
            { name: "Lv3: 200-300å…ƒç¤¼ç‰©", color: "#fdffb6", weight: 30, score: 60 },
            { name: "Lv2: 100-200å…ƒå°ç‰©", color: "#caffbf", weight: 30, score: 100 },
            { name: "Lv1: å¥¶èŒ¶/é›¶é£ŸåŒ…",   color: "#9bf6ff", weight: 20, score: 150 }
        ];
        // =========================================

        const wheel = document.getElementById('wheel');
        let isSpinning = false;

        // åˆå§‹åŒ–è½¬ç›˜èƒŒæ™¯ï¼ˆconic-gradientï¼‰
        function initWheel() {
            let gradientStr = '';
            let currentPercent = 0;
            const segmentSize = 100 / prizes.length; // è§†è§‰ä¸Šå¹³åˆ†æ‰‡å½¢ï¼ˆè™½ç„¶æ¦‚ç‡ä¸åŒï¼Œä½†è§†è§‰å¹³åˆ†æ›´å¥½çœ‹ï¼‰

            prizes.forEach((prize, index) => {
                const start = currentPercent;
                const end = currentPercent + segmentSize;
                gradientStr += `${prize.color} ${start}% ${end}%,`;
                currentPercent += segmentSize;
            });
            
            // å»æ‰æœ€åä¸€ä¸ªé€—å·
            gradientStr = `conic-gradient(${gradientStr.slice(0, -1)})`;
            wheel.style.background = gradientStr;
        }

        initWheel();

        // æ ¸å¿ƒæŠ½å¥–é€»è¾‘
        function getPrizeIndex() {
            const totalWeight = prizes.reduce((sum, p) => sum + p.weight, 0);
            let random = Math.random() * totalWeight;
            
            for (let i = 0; i < prizes.length; i++) {
                random -= prizes[i].weight;
                if (random <= 0) {
                    return i;
                }
            }
            return prizes.length - 1;
        }

        function startSpin() {
            if (isSpinning) return;
            isSpinning = true;

            // 1. è®¡ç®—ä¸­å¥–ç»“æœ
            const prizeIndex = getPrizeIndex();
            const prize = prizes[prizeIndex];

            // 2. è®¡ç®—æ—‹è½¬è§’åº¦
            // è§†è§‰ä¸Šå¹³åˆ†ï¼Œæ‰€ä»¥æ¯ä¸ªæ‰‡å½¢è§’åº¦æ˜¯ 360 / æ•°é‡
            const segmentDeg = 360 / prizes.length;
            // ç›®æ ‡æ˜¯æŒ‡é’ˆæŒ‡å‘è¯¥æ‰‡å½¢ä¸­é—´ã€‚ç”±äºæŒ‡é’ˆåœ¨æ­£ä¸Šæ–¹(0åº¦)ï¼Œæˆ‘ä»¬éœ€è¦åå‘æ—‹è½¬
            // åŸºç¡€æ—‹è½¬åœˆæ•° (5åœˆä»¥ä¸Šï¼Œå¢åŠ ç´§å¼ æ„Ÿ)
            const baseRotations = 360 * 8; 
            // è®¡ç®—ç›®æ ‡æ‰‡å½¢çš„ä¸­å¿ƒè§’åº¦ï¼ˆå‡è®¾ç¬¬0ä¸ªåœ¨0-72åº¦ï¼‰
            // æˆ‘ä»¬éœ€è¦è®©è½®ç›˜è½¬åŠ¨ï¼Œä½¿å¾—è¯¥æ‰‡å½¢åœåœ¨ä¸Šæ–¹
            // ç®€å•çš„æ•°å­¦å¤„ç†ï¼šéšæœºè½ç‚¹åœ¨æ‰‡å½¢èŒƒå›´å†…
            const randomOffset = Math.random() * (segmentDeg - 10) + 5; // ç•™ç‚¹è¾¹è·
            // ç›®æ ‡è§’åº¦è®¡ç®—é€»è¾‘ï¼šä¸ºäº†è®©ç‰¹å®šå—åœåœ¨ä¸Šé¢ï¼Œéœ€è¦ç²¾ç»†è®¡ç®—ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†ï¼š
            // å› ä¸ºCSSæ—‹è½¬æ˜¯é¡ºæ—¶é’ˆï¼Œ0åº¦åœ¨12ç‚¹ã€‚
            // å®é™…ä¸Šä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬è®©å®ƒè½¬åˆ°ä¸€ä¸ªå¤§æ¦‚ä½ç½®ï¼Œé‡ç‚¹æ˜¯é€»è¾‘ç»“æœ
            // è¿™é‡Œä¸ºäº†ç²¾å‡†åŒ¹é…è§†è§‰ï¼Œæˆ‘ä»¬åæ¨ï¼š
            // ç¬¬iä¸ªæ‰‡å½¢çš„èµ·å§‹è§’åº¦æ˜¯ i * segmentDeg
            // è¦è®©å®ƒåœåœ¨12ç‚¹ï¼Œéœ€è¦è½¬åŠ¨çš„è§’åº¦ = (360 - (i * segmentDeg + segmentDeg/2)) 
            const stopAngle = (360 - (prizeIndex * segmentDeg + segmentDeg / 2));
            
            const totalRotate = baseRotations + stopAngle;

            // 3. æ‰§è¡ŒåŠ¨ç”»
            wheel.style.transform = `rotate(${totalRotate}deg)`;

            // 4. åŠ¨ç”»ç»“æŸåå¼¹çª—
            setTimeout(() => {
                showResult(prize);
                isSpinning = false;
                // é‡ç½®è½¬ç›˜è§’åº¦ï¼ˆå¯é€‰ï¼Œä¸ºäº†ä¸‹æ¬¡æ—‹è½¬ä¸ç´¯åŠ å¤ªå¤§æ•°å­—ï¼Œä½†ä¸ºäº†è§†è§‰è¿è´¯é€šå¸¸ä¸é‡ç½®æˆ–ç”¨ç‰¹æ®Šå¤„ç†ï¼‰
                // è¿™é‡Œçš„ç®€æ˜“ç‰ˆå°±ä¸é‡ç½®äº†ï¼Œä¸‹æ¬¡ç›´æ¥åœ¨è¿™ä¸ªåŸºç¡€ä¸ŠåŠ 
            }, 4000); // 4ç§’å’ŒCSSé‡Œçš„transitionæ—¶é—´ä¸€è‡´
        }

        function showResult(prize) {
            const modal = document.getElementById('modal');
            const text = document.getElementById('resultText');
            const score = document.getElementById('resultScore');

            text.innerHTML = `æ­å–œæŠ½ä¸­ï¼š<br><strong>${prize.name}</strong>`;
            score.innerHTML = `è·å¾—ç§¯åˆ†ï¼š+${prize.score}`;
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }
    </script>
</body>
</html>